<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Capybara Hunt</title>
  <link rel="stylesheet" href="css/hunt.css">
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.152.2/build/three.module.js"
    }
  }
  </script>
  <script type="module" src="js/viewer.js"></script>
  <!-- Firebase SDK (Compat version for non-module use) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <!-- Header Image with Red Background Bar -->
      <div class="header-bar">
        <img src="samples/Cappa+WithAsterisk@3x.png" alt="Capybara" class="header-image" />
      </div>
      
      <!-- Subheader Text -->
      <div class="subheader">
        <p>Hidden inside the school, there are 50 tiny capybaras. Your goal is to find the most amount of them.</p>
        <p>When you find one, enter its code into this website's code box below.</p>
        
        <h2>Rules:</h2>
        <ul>
          <li>Objects do not need to be broken to find a Capy.</li>
          <li>Capys are not inside of classrooms; do not disturb them.</li>
          <li>Moving of Capys or their code will get you eliminated.</li>
          <li>A Capy's code cannot be entered more than once per player.</li>
          <li>You can work together in teams.</li>
        </ul>
        
        <p><strong>Scoring:</strong><br>
        Each capybara is worth 1 point at first scan; after that, its worth drops to 0.5.</p>
        
        <p>Out of the 100, there is a golden one worth 10 points, but after being scanned, its worth drops to 1.</p>
        
        <p>Once all Capys are found or it reaches the 20th, the event is over.</p>
        
        <p style="text-align:center;font-weight:bold;margin-top:16px">Happy Hunting. üíï</p>
      </div>
      
      <div id="count-display">
        <div class="big-number">100</div>
        <div class="label">remaining</div>
      </div>
    </header>

    <main>
      <!-- 3D Viewer with HUD Overlays -->
      <div style="position:relative;margin-bottom:24px;display:inline-block;width:100%">
        <div id="stl-viewer" class="viewer-box"></div>
        
        <!-- HUD Widget: Admin (Locked by default) -->
        <div style="position:absolute;bottom:12px;left:12px;background:rgba(0,0,0,0.75);color:#fff;padding:12px;border-radius:8px;font-size:12px;width:140px;z-index:10">
          <div style="font-weight:bold;margin-bottom:8px">Admin</div>
          <button id="download-codes-hud" class="btn-hud btn-disabled" disabled>Download</button>
          <button id="reset-all-hud" class="btn-hud btn-disabled" disabled>Reset</button>
          <button id="admin-unlock-btn" class="btn-hud" style="background:#666;margin-top:8px">Unlock</button>
        </div>

        <!-- HUD Widget: About -->
        <div style="position:absolute;bottom:12px;right:12px;background:rgba(0,0,0,0.75);color:#fff;padding:12px;border-radius:8px;font-size:11px;width:160px;z-index:10">
          <div style="font-weight:bold;margin-bottom:6px">About</div>
          <div style="line-height:1.3;opacity:0.9">
            ‚Üê This is what you're looking for! 
          </div>
        </div>
      </div>

      <!-- Password Modal -->
      <div id="password-modal" style="position:fixed;inset:0;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:1000;display:none">
        <div style="background:#fff;padding:32px;border-radius:12px;max-width:300px;box-shadow:0 10px 40px rgba(0,0,0,0.3)">
          <h2 style="margin:0 0 16px 0;font-size:20px">Admin Password</h2>
          <input id="admin-password" type="password" placeholder="Enter password" autocomplete="off" style="width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;font-size:14px;margin-bottom:16px;box-sizing:border-box" />
          <div style="display:flex;gap:8px">
            <button id="modal-submit" class="btn-primary" style="flex:1">Unlock</button>
            <button id="modal-cancel" class="btn-secondary" style="flex:1;background:#999">Cancel</button>
          </div>
        </div>
      </div>

      <!-- Scan Section (Home) -->
      <section class="section">
        <h2>Enter Code</h2>
        <div style="display:flex;gap:8px;margin-bottom:24px">
          <input id="code-input" type="text" placeholder="e.g., CP-1A2B" />
          <button id="add-code" class="btn-primary">Add</button>
        </div>
      </section>

      <!-- Recent -->
      <section class="section">
        <h2>Recent</h2>
        <ul id="feed" class="feed"></ul>
      </section>

      <!-- Grid -->
      <section class="section">
        <h2>Capas to Find</h2>
        <div id="grid" class="grid"></div>
      </section>

      <!-- Leaderboard -->
      <section class="section">
        <h2>Leaderboard</h2>
        <div id="leaderboard" class="leaderboard"></div>
      </section>
    </main>
  </div>

  <script src="js/hunt.js"></script>
</body>
</html>
